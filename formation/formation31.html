<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Palettes de couleurs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../formation/formation32.html" rel="next">
<link href="../formation/formation23.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Graphiques</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_fr/">Retour Stata-Ined</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_programmation">Programmation</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mthevenin"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marc.thevenin@ined.fr"><i class="bi bi-envelope" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">A propos</a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Palettes de couleurs</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Formation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Chapitre 1: syntaxe</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation11.html" class="sidebar-item-text sidebar-link">Types et syntaxe</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation12.html" class="sidebar-item-text sidebar-link">Options: couleur, épaisseur</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation13.html" class="sidebar-item-text sidebar-link">Options: légende, titre…</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation14.html" class="sidebar-item-text sidebar-link">Combiner des graphiques</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Chapitre 2: macros</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation21.html" class="sidebar-item-text sidebar-link">Rappels sur les macros</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation22.html" class="sidebar-item-text sidebar-link">Alleger la syntaxe</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation23.html" class="sidebar-item-text sidebar-link">Automatiser la programmation</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Chapitre 3: palettes et styles</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation31.html" class="sidebar-item-text sidebar-link active">Palettes de couleurs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../formation/formation32.html" class="sidebar-item-text sidebar-link">Styles-thèmes</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">Chapitre 4: [A venir]</span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">Chapitre 5: [A venir]</span>
  </li>
          <li class="sidebar-item">
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Ressources graphiques</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Stata.html" class="sidebar-item-text sidebar-link">Graphiques Stata</a>
  </div>
</li>
          <li class="sidebar-item">
  Python.qmd
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#les-palettes-usines" id="toc-les-palettes-usines" class="nav-link active" data-scroll-target="#les-palettes-usines"><strong>Les palettes usines</strong></a></li>
  <li><a href="#colorpalette-ben-jann" id="toc-colorpalette-ben-jann" class="nav-link" data-scroll-target="#colorpalette-ben-jann"><strong>Colorpalette (Ben Jann)</strong></a>
  <ul class="collapse">
  <li><a href="#principales-options-et-altération-dune-palette" id="toc-principales-options-et-altération-dune-palette" class="nav-link" data-scroll-target="#principales-options-et-altération-dune-palette"><strong>Principales options et altération d’une palette</strong></a>
  <ul class="collapse">
  <li><a href="#utilisation-de-colorpalette-pour-générer-un-graphique" id="toc-utilisation-de-colorpalette-pour-générer-un-graphique" class="nav-link" data-scroll-target="#utilisation-de-colorpalette-pour-générer-un-graphique"><strong>Utilisation de colorpalette pour générer un graphique</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exemples-de-palettes" id="toc-exemples-de-palettes" class="nav-link" data-scroll-target="#exemples-de-palettes"><strong>Exemples de palettes</strong></a>
  <ul class="collapse">
  <li><a href="#palettes-qualitatives" id="toc-palettes-qualitatives" class="nav-link" data-scroll-target="#palettes-qualitatives"><strong>Palettes qualitatives</strong></a></li>
  <li><a href="#palettes-séquentielles" id="toc-palettes-séquentielles" class="nav-link" data-scroll-target="#palettes-séquentielles"><strong>Palettes séquentielles</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Palettes de couleurs</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><br> Lorsqu’ils sont générés, les graphiques appliquent un thème/style par défaut:</p>
<ul>
<li><p>Ces thèmes sont appelés scheme.</p></li>
<li><p>Les options de la commande graphique visent à modifier les paramètres du thème.</p></li>
<li><p>Les paramètres du style/thèmes sont appliqués aux couleurs, tailles/épaisseurs, positions des éléments de texte, définitions des axes….</p></li>
<li><p>Stata dispose de 5 thèmes officiels. Des thèmes externes ont été programmés et peuvent être installés. La série de commandes associées à <strong><code>grstyle</code></strong> (<em>Ben Jann</em>) permet de paramétrer très facilement un thème, a minima en 2-3 lignes avec un nombre très réduit d’arguments.</p></li>
<li><p>Collection <strong><code>schemepack</code></strong> : récemment (2021), <em>Asjad Naqvi</em> a programmé une suite de thèmes à partir du paquet <code>grstyle</code>. Cette série offre une alternative très séduisante au thèmes usines vieillissants de Stata.</p></li>
<li><p>Les thèmes utilisent des palettes de couleurs. Il existe 3 types de palettes selon la nature des données.</p>
<ul>
<li><strong><em>Palettes qualitatives</em></strong> (variables discrètes).</li>
<li><strong><em>Palettes séquentielles</em></strong> (variables ordonnées/quantitatives).</li>
<li><strong><em>Palettes divergentes</em></strong> (variables ordonnées/quantitatives avec deux sens implicites et une valeur pivot</li>
</ul></li>
<li><p>Des commandes externes permettent d’augmenter le nombre de palettes mises à disposition par Stata, de les modifier ou de les créer.</p></li>
<li><p>Pour la cartographie, la commande <code>spmap</code> (<em>Maurizio Pisatti</em>) intègre une quarantaine de palettes, principalement séquentielles (commande à visée cartographique).</p></li>
<li><p>La librairie <code>brewscheme</code> (William Buchanan) dispose de plusieurs commandes pour générer des palettes de couleurs. Son utilisation est assez complexe.</p></li>
<li><p>La commande **<code>colorpalette</code> (Benn Jann) charge plusieurs dizaines de palettes de couleurs, de tout type, permet de les modifier, d’en créer, et de les utiliser facilement dans la création de graphiques. Elle est indispensable dès lors qu’on souhaite utiliser efficacement des couleurs différentes de celles fournies par le logiciel. Cette commande, à mon sens incontournable, sera longuement traitée dans ce chapitre, ainsi que la commande <code>grstyle</code> qui reprend sa syntaxe pour générer de manière rapide un thème.</p></li>
</ul>
<section id="les-palettes-usines" class="level1">
<h1><strong>Les palettes usines</strong></h1>
<p>Stata dispose de 5 palettes de couleurs usines qui sont associées à des thèmes graphiques. Par exemple la <em>palette s2</em> est associée au <em>thème s2color</em>.</p>
<p>Les palettes associées aux thèmes Stata sont de type qualitative. L’ordre d’utilisation des couleurs dans un graphique composé de plusieurs objets est pensé de tel sorte que des couleurs même type, par exemple le bleu, ne se succède pas.</p>
<p><img src="imgp3/g1.png" class="img-fluid" style="width:60.0%"></p>
<p>Les numéros sur l’abscisse correspondent à l’ordre par défaut d’utilisation des couleurs.Les couleurs usines ont un nom, auquel correspond un code RGB.</p>
<p><img src="imgp3/g2.png" class="img-fluid" style="width:60.0%"></p>
<p>La palette <strong>mono</strong> d’avère très utile pour modifier les couleurs des titres, labels, grids ou du background. Elle est ambivalente, l’ordre par défaut de la palette est plutôt qualitatif, mais le nom des couleurs correspond à une palette séquentielle appelé « grey scale » (gs# avec # allant de 0 – noir – à 16 – blanc).</p>
<p><img src="imgp3/g3.png" class="img-fluid" style="width:60.0%"></p>
<p><img src="imgp3/g4.png" class="img-fluid" style="width:60.0%"></p>
<p><em>Remarque</em>: il est facile de générer une couleur appartenant à une palette correspondant à une échelle de gris: les trois valeurs du code RGB étant identique (compris entre 0 et 255).</p>
<p><br> On est vite limité avec les palettes usines de Stata. Malgré les efforts de plusieurs utilisateurs pour augmenter leur nombre (M.Pissatti, F.Briatte, D.Bischoff…), la commande <strong><code>colorpalette</code></strong> (Ben Jann) a récemment permis de démultiplier quasiment à l’infini les possibilités en terme de manipulation des couleurs.</p>
</section>
<section id="colorpalette-ben-jann" class="level1">
<h1><strong>Colorpalette (Ben Jann)</strong></h1>
<p><strong><em>Installation</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ssc install palettes  [, replace force]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ssc install colrspace [, replace force]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<strong><em>Syntaxe générique</em></strong>
<div class="grey">

<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a> colorpalette nom_palette<span class="sc">/</span>collection [, nom_sous_palette] [options]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Remarque</em>: le nom d’une palette peut être une couleur ou une série de couleur</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Charge et affiche la palette s1 de Stata </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>colorpalette s1 </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Charge et affiche la palette hue </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>colorpalette hue </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Charge et affiche la palette viridis </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>colorpalette viridis </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Charge et affiche la palette summer de la collection matplotlib </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>colorpalette matplotlib, summer</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Charge et affiche une palette composée des couleur bleu et rouge</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>colorpalette blue red</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour visualiser les palettes disponibles : <strong><code>help colorpalette</code></strong>.</p>
<p><strong>Exemple : la palette plasma</strong></p>
<ul>
<li>Appartient à la <em><strong>collection viridis</strong>, palettes Python visant à remplacer les palettes de la </em>collection matplotlib* (intégrée à <code>colorpalette</code>)</li>
<li>Longueur par défaut : 15 couleurs</li>
<li>Type : séquentielle</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>colorpalette plasma</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g5a.png" class="img-fluid" style="width:60.0%"></p>
<p><br></p>
<section id="principales-options-et-altération-dune-palette" class="level2">
<h2 class="anchored" data-anchor-id="principales-options-et-altération-dune-palette"><strong>Principales options et altération d’une palette</strong></h2>
<p><strong>Modifier la taille de la palette: <code>n(#)</code></strong></p>
<p>Important car la réduction de la taille pour certaines palettes ne consiste pas à prendre les # premiers éléments de la palette par défaut (cf palettes <em>hu</em>e ou <em>viridis</em>), mais forcer une palette non qualitative, donc plutôt séquentielle, à produire une palette réduite avec des types de couleurs contrastées plutôt qualitative.</p>
<p><strong>Modifier l’intensité ou l’opacité : intensity(#), opacity(#) et ipolate(#)</strong></p>
<ul>
<li><p>On peut modifier l’intensité (saturation) ou l’opacité d’une palette avec <strong><code>intensity(#)</code> ou </strong><code>intensity(numlist)</code>** et <strong><code>opacity(#)</code></strong>.</p></li>
<li><p>On peut créer une palette séquentielle à partir d’une couleur de départ avec <strong><code>intensity(#1(delta)#2)</code></strong>.</p></li>
<li><p>On peut créer une palette divergente avec des couleurs de départ, d’arrivée et de transition avec <strong><code>ipolate(#)</code></strong>.</p></li>
</ul>
<p><strong>Select – reverse - nograph</strong></p>
<ul>
<li><p>On peut sélectionner des couleurs d’une palette avec <strong><code>select(numlist)</code></strong>. L’option autorise la répétition de couleurs, utile lorsque plusieurs objets graphiques partage une même couleur au sein d’un graphique (exemple nuages de point et courbes pour différentes valeurs d’une variable additionnelle : voir exemple avec <code>grstyle</code>).</p></li>
<li><p>On peut inverser l’ordre des couleurs de la palette: <strong><code>reverse</code></strong>.</p></li>
<li><p>Ne pas afficher la palette: <strong><code>nograph</code></strong> [voir <em>utilisation de colorpalette pour générer un graphique</em>]. Après avoir séléctionné les couleurs, à utiliser systématiquement pour charger la palette avant son utilisation dans un graphique. Cela réduit considérablement le temps d’exécution.</p></li>
</ul>
<p><strong><em>Création d’une palette de 4 couleurs</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>colorpalette plasma, <span class="fu">n</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g5b.png" class="img-fluid" style="width:60.0%"></p>
<p><strong><em>Répétition d’une liste de couleur avec select(numlist)</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>colorpalette plasma,  <span class="fu">select</span>(<span class="dv">1</span> <span class="dv">8</span> <span class="dv">15</span> <span class="dv">1</span> <span class="dv">8</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g5g.png" class="img-fluid" style="width:60.0%"></p>
<p><strong><em>Création d’une palette séquentielle avec augmentation de l’intensité</em></strong></p>
<p>A partir de la couleur 3 (RGB= 237,121,83), création d’une palette sequentielle d’une longueur de 15, allant de “237,121,83<em>0” (proche blanc) à ”237,121,83</em>15”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>colorpalette <span class="st">"237 121 83"</span>, <span class="fu">intensity</span>(<span class="dv">0</span>(.<span class="dv">1</span>)<span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g5c.png" class="img-fluid" style="width:60.0%"></p>
<p><strong><em>Création d’une palette séquentielle avec augmentation de l’intensité</em></strong></p>
<p>Création d’une palette séquentielle d’une longueur 15 allant de la couleur 1 à la couleur 3 de la palette plasma à 4 couleurs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>colorpalette <span class="st">"13 8 135"</span> <span class="st">"237 121 83"</span>, <span class="fu">ipolate</span>(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g5d.png" class="img-fluid" style="width:60.0%"></p>
<p>Si on ajoute la couleur 2 de la palette d’origine comme couleur de transition</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>colorpalette <span class="st">"13 8 135"</span> <span class="st">"156 23 158"</span>  <span class="st">"237 121 83"</span>, <span class="fu">ipolate</span>(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g5e.png" class="img-fluid" style="width:60.0%"></p>
<p>Si on utilise le blanc comme couleur de transition, on obtient une palette divergente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>colorpalette <span class="st">"13 8 135"</span> white <span class="st">"237 121 83"</span>, <span class="fu">ipolate</span>(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g5f.png" class="img-fluid" style="width:60.0%"></p>
<p><strong>Créer, enregistrer et charger sa propre palette</strong></p>
<p><code>colorpalette</code> permet de conserver en mémoire sa propre palette, en la générant dans un .ado (voir la fin du chapitre dédié aux macros) ou dans le programme principal. Par exemple avec la palette issue du premier exemple (palette plasma à 4 couleur).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Création de la palette mypal</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>capt program drop colorpalette_mypal</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>program colorpalette_mypal</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>c_local P <span class="dv">13</span> <span class="dv">8</span> <span class="dv">135</span>, <span class="dv">156</span> <span class="dv">23</span> <span class="dv">158</span>, <span class="dv">237</span> <span class="dv">121</span> <span class="dv">83</span>, <span class="dv">240</span> <span class="dv">249</span> <span class="dv">33</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>c_local class qualitative</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> On charge la palette avec la commande colorpalette_mypal</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>colorpalette_mypal</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> On affiche la palette my_pal</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>colorpalette my_pal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="utilisation-de-colorpalette-pour-générer-un-graphique" class="level3">
<h3 class="anchored" data-anchor-id="utilisation-de-colorpalette-pour-générer-un-graphique"><strong>Utilisation de colorpalette pour générer un graphique</strong></h3>
<p>On remarque, avec return list, que la commande génère une liste de macros qui enregistre les codes RGB des couleurs de la palette.</p>
<ul>
<li>la macro <code>r(p)</code> permet d’utiliser les couleurs de la palette dans un graphique à un seul bloc d’éléments.</li>
<li>les macros <code>r(p#)</code> permettent d’utiliser les couleurs dans un graphique composé de plusieurs éléments.</li>
</ul>
<p>La commande <code>colorpalette</code> n’est qu’un générateur de couleurs qui renvoie une liste de codes RGB sous forme de macros. Si pour des graphiques simples la technique du « copié/collé » de codes RGB reste possible, l’utilisation des macros va être une nouvelle fois fortement recommandée. On peut déjà néanmoins indiquer qu’avec le générateur de thème **<code>grstyle</code> (voir la section suivante), également programmé par <em>B.Jann</em>, une sélection de couleurs pourra être directement intégrée à un graphique sans manipulation supplémentaire.</p>
<p><strong>Macros générées par <code>colorpalette</code></strong></p>
<p>On va partir de la palette plasma précédente avec 4 couleurs et un % d’opacité de 80%. Avec return list, on affiche sous forme de macros la liste des codes RGB des couleurs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>colorpalette plasma, <span class="fu">n</span>(<span class="dv">4</span>) <span class="fu">opacity</span>(<span class="dv">80</span>) nograph</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>return list</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">*</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>scalars<span class="sc">:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">r</span>(n) <span class="ot">=</span>  <span class="dv">4</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>macros<span class="sc">:</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">r</span>(ptype) <span class="sc">:</span> <span class="st">"color"</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">r</span>(pname) <span class="sc">:</span> <span class="st">"plasma"</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">r</span>(pnote) <span class="sc">:</span> <span class="st">"plasma colormap from matplotlib.org"</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">r</span>(psource) <span class="sc">:</span> <span class="st">"https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/_cm_listed.py"</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">r</span>(pclass) <span class="sc">:</span> <span class="st">"sequential"</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">r</span>(p) <span class="sc">:</span> <span class="st">""</span><span class="dv">13</span> <span class="dv">8</span> <span class="dv">135</span><span class="sc">%80" "156 23 158%</span><span class="dv">80</span><span class="st">" "</span><span class="dv">237</span> <span class="dv">121</span> <span class="dv">83</span><span class="sc">%80" "240 249 33%</span><span class="dv">80</span><span class="st">""</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">r</span>(p4) <span class="sc">:</span> <span class="st">"240 249 33%80"</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">r</span>(p3) <span class="sc">:</span> <span class="st">"237 121 83%80"</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">r</span>(p2) <span class="sc">:</span> <span class="st">"156 23 158%80"</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">r</span>(p1) <span class="sc">:</span> <span class="st">"13 8 135%80"</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span><span class="er">/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La liste renvoie la macro r(p) qui liste l’ensemble des codes couleurs. Cette macro est utilisée pour les graphiques avec un seul objet qui liste pour l’axe des ordonnées une série de variables.</p>
<p><strong><em>Exemple</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sysuse uslifeexp</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>colorpalette plasma, <span class="fu">n</span>(<span class="dv">4</span>) <span class="fu">opacity</span>(<span class="dv">80</span>) nograph</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>tw line le_wmale le_wfemale le_bmale le_bfemale year, <span class="fu">lc</span>(<span class="st">`</span><span class="at">r(p)')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La macro <code>r(p)</code> a déjà deux doubles quotes, on ne doit pas enfermer cette liste par ““.</p>
<p>La liste de macros <code>r(p#)</code> renvoie le code couleur de chaque élément de la palette, ici <code>r(p1)</code> à <code>r(p4)</code>. Ces macros sont utilisées pour les graphiques composés de plusieurs objets. Entrée directement dans la syntaxe d’un graphique, ces macros devront être enfermées dans des doubles quotes.</p>
<p><strong><em>Exemple</em></strong><br>
On va afficher un graphique avec 4 densités sous forme d’aires générées aléatoirement. De nouveau on utilisera la palette plasma réduite à 4 couleurs et 80% d’opacité.</p>
<p><em>Données</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>clear</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>set obs <span class="dv">1000</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>gen y1<span class="ot">=</span> <span class="fu">rnormal</span>(<span class="dv">0</span>,<span class="fl">1.5</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>gen y2<span class="ot">=</span> <span class="fu">rnormal</span>(<span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>gen y3<span class="ot">=</span> <span class="fu">rnormal</span>(<span class="dv">6</span>, <span class="dv">3</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>gen y4<span class="ot">=</span> <span class="fu">rnormal</span>(<span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>forv i<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">4</span> {</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>kdensity y<span class="st">`</span><span class="at">i', n(500) gen(x</span><span class="st">`</span>i<span class="st">' d`i'</span><span class="er">)</span> nograph</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Graphique</em> (sans macros empilées pour faciliter la lisibilité du programme)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Colorpalette plasma , <span class="fu">n</span>(<span class="dv">4</span>) <span class="fu">opacity</span>(<span class="dv">80</span>) nograph</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>local ops <span class="fu">lc</span>(black) <span class="fu">lw</span>(<span class="sc">*</span>.<span class="dv">5</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit ;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>tw line d1 x1,  <span class="fu">recast</span>(area) <span class="st">`</span><span class="at">ops' fc("</span><span class="st">`</span><span class="fu">r</span>(p1)<span class="st">'")  </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">|| line d2 x2,  recast(area) `ops'</span> <span class="fu">fc</span>(<span class="st">"`r(p2)'"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span> line d3 x3,  <span class="fu">recast</span>(area) <span class="st">`</span><span class="at">ops' fc("</span><span class="st">`</span><span class="fu">r</span>(p3)<span class="st">'") </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">|| line d4 x4,  recast(area) `ops'</span> <span class="fu">fc</span>(<span class="st">"`r(p4)'"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span>, <span class="fu">legend</span>(<span class="fu">order</span>(<span class="dv">1</span> <span class="st">"r(p1)"</span> <span class="dv">2</span> <span class="st">"r(p2)"</span> <span class="dv">3</span> <span class="st">"r(p3)"</span> <span class="dv">4</span> <span class="st">"r(p4)"</span>) <span class="fu">pos</span>(<span class="dv">11</span>) <span class="fu">row</span>(<span class="dv">1</span>) <span class="fu">region</span>(<span class="fu">color</span>(%<span class="dv">0</span>))) </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g6a.png" class="img-fluid" style="width:60.0%"></p>
<p>Sans modifier la syntaxe du graphique, on peut alors simplement changer de palette, en modifiant son nom et/ou en modifiant une ou plusieurs options comme l’opacité.</p>
<p><strong><em>Exemple</em></strong>: <em>palette winte</em>r de la collection <em>matplotlib</em>, avec 50% d’opacité et en inversant l’ordre des couleurs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>colorpalette plasma , <span class="fu">n</span>(<span class="dv">4</span>) <span class="fu">opacity</span>(<span class="dv">80</span>) nograph</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>local ops <span class="fu">lc</span>(black) <span class="fu">lw</span>(<span class="sc">*</span>.<span class="dv">5</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit ;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>tw line d1 x1,  <span class="fu">recast</span>(area) <span class="st">`</span><span class="at">ops' fc("</span><span class="st">`</span><span class="fu">r</span>(p1)<span class="st">'")  </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="st">|| line d2 x2,  recast(area) `ops'</span> <span class="fu">fc</span>(<span class="st">"`r(p2)'"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span> line d3 x3,  <span class="fu">recast</span>(area) <span class="st">`</span><span class="at">ops' fc("</span><span class="st">`</span><span class="fu">r</span>(p3)<span class="st">'") </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="st">|| line d4 x4,  recast(area) `ops'</span> <span class="fu">fc</span>(<span class="st">"`r(p4)'"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span>, <span class="fu">legend</span>(<span class="fu">order</span>(<span class="dv">1</span> <span class="st">"`r(p1)'"</span> <span class="dv">2</span> <span class="st">"`r(p2)'"</span> <span class="dv">3</span> <span class="st">"`r(p3)'"</span> <span class="dv">4</span> <span class="st">"`r(p4)'"</span>) </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pos</span>(<span class="dv">11</span>) <span class="fu">row</span>(<span class="dv">1</span>) <span class="fu">region</span>(<span class="fu">color</span>(%<span class="dv">0</span>))) </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Remarque : en utilisant les macros dans la légende, on a affiché les codes couleurs</em></p>
<p><img src="imgp3/g6b.png" class="img-fluid" style="width:60.0%"></p>
</section>
</section>
</div></section>
<section id="exemples-de-palettes" class="level1">
<h1><strong>Exemples de palettes</strong></h1>
<p>Sur le même principe que les deux graphiques précédents mais avec 6 éléments, on a mis à disposition une petite commande, <strong><code>testpal</code></strong>, qui permet de tester le rendu d’un graphique. La commande reporte 6 objets graphiques sous la forme de densités représentées par des aires et par des groupes. Les deux graphiques de la première colonne sont sur un fond blanc, ceux de la deuxième colonne sont sur un fond paramétrable (palette gs) par défaut très sombre.</p>
<p><strong><em>Installation</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>net install testpal, <span class="fu">from</span>(<span class="st">"https://mthevenin.github.io/stata_fr/ado/testpal/"</span>) replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<strong><em>Syntaxe</em></strong>
<div class="grey">

<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>testpal nom_palette , [rev] [<span class="fu">op</span>(<span class="co">#)] [bf(#)]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>rev</code>: inverse l’ordre des couleurs de la palette.</li>
<li><code>op(#)</code>: modifie le pourcentage d’opacité des couleurs. Par défaut 100% (op(100)). # est compris entre 0+ et 100.</li>
<li><code>bf(#)</code>: permet de modifier la clarté des graphiques de la seconde colonne (blanc pour la première). # est une valeur comprise entre 1 (noir) et 14 (presque blanc).</li>
</ul>
<p><strong><em>Exemple avec la palette qualitative burd (François Briatte)</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>testpal burd, rev <span class="fu">op</span>(<span class="dv">100</span>) <span class="fu">bf</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp3/g7a.png" class="img-fluid" style="width:60.0%"></p>
<p>Pour les quelques palettes populaires qui vont être rapidement présentées, les options de la commande <code>testpal</code> n’ont pas été modifiées. Le nom de la palette est donné par le titre du graphique.</p>
<p><br></p>
<section id="palettes-qualitatives" class="level2">
<h2 class="anchored" data-anchor-id="palettes-qualitatives"><strong>Palettes qualitatives</strong></h2>
<p><strong>Tableau</strong></p>
<p><strong>https://www.tableau.com/about/blog/2016/7/colors-upgrade-tableau-10-56782</strong></p>
<p><img src="imgp3/g7b.png" class="img-fluid" style="width:60.0%"></p>
<p><strong>HUE</strong></p>
<ul>
<li>Il s’agit de la palette par défaut de ggplot2 (R)</li>
<li>De plus en plus remplacée par la palette Viridis (voir plus loin)</li>
</ul>
<p><img src="imgp3/g7c.png" class="img-fluid" style="width:60.0%"></p>
</section>
<section id="palettes-séquentielles" class="level2">
<h2 class="anchored" data-anchor-id="palettes-séquentielles"><strong>Palettes séquentielles</strong></h2>
<ul>
<li>Utilisées massivement en cartographie et plus généralement pour représenter des fréquences (graphique type barre) ou des valeurs ordonnées</li>
<li>Couleurs allant du plus clair au plus foncé (ou inversement). – Modification de l’intensité d’une couleur. – Une ou plusieurs gammes de couleurs : par exemples du jaune au rouge, du jaune au bleu…</li>
</ul>
<p>En réduisant la taille de certaines palettes séquentielles ou divergentes, on peut obtenir une palette plutôt qualitative. C’est le cas de la collection, très en vogue, <em>Viridis</em>.</p>
<p><strong>Collection viridis</strong></p>
<ul>
<li>La palette <strong>Viridis</strong> et les ses palettes associées (plasma, magma, cividis…) est la palette “star” du moment.</li>
<li>Développée pour Python pour donner une palette alternative à <em>Matplotlib</em>, elle est devenue la palette par défaut de la librairie graphique</li>
<li>Avantages:
<ul>
<li>Même rendu, ou très proche, des couleurs sur toutes les parties d’un écran (uniformité).</li>
<li>Différences de couleurs maintenue à l’impression n&amp;b.</li>
<li>Gère la plupart des formes de daltonisme.<br>
</li>
</ul></li>
<li>Limites : pour les courbes, un fond blanc ou très clair ou un fond noir ou très foncé, les couleurs aux extrémités passent difficilement. Prévoir un fond gris moyen ou ne pas sélectionner les couleurs aux extrémités de la palette.</li>
<li>Les autres palettes : plasma est également très utilisée, en particulier pour le remplissage de surface (aire).</li>
<li>Plus d’infos : <strong>https://rtask.thinkr.fr/fr/ggplot2-welcome-viridis/</strong></li>
</ul>
<p><img src="imgp3/g7d.png" class="img-fluid" style="width:60.0%"></p>
<p><img src="imgp3/g7e.png" class="img-fluid" style="width:60.0%"></p>
<p><strong>Collection colorbrewer</strong></p>
<p>Très populaire en cartographie: <strong>https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3</strong></p>
<p><img src="imgp3/g7f.png" class="img-fluid" style="width:60.0%"></p>
<p>On présentera enfin une seule palette de type divergente, issue de cette collection, la palette <em>spectral</em>.</p>
<p><img src="imgp3/g7g.png" class="img-fluid" style="width:60.0%"><br>
<br></p>


</section>
</div></section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../formation/formation23.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Automatiser la programmation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../formation/formation32.html" class="pagination-link">
        <span class="nav-page-text">Styles-thèmes</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Marc Thévenin - Ined-Sms - Août 2022</div>
  </div>
</footer>



</body></html>