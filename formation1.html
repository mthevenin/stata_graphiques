<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapitre 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Graphiques</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mthevenin/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/stata_fr/">Retour Stata-Ined</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mthevenin.github.io/formation_stata">[en cours: programmation]</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mthevenin"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marc.thevenin@ined.fr"><i class="bi bi-envelope" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">A propos</a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Chapitre 1</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Formation</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Chapitre 1: syntaxe</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation11.html" class="sidebar-item-text sidebar-link">Types et syntaxe</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation12.html" class="sidebar-item-text sidebar-link">Options: couleur, épaisseur</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation13.html" class="sidebar-item-text sidebar-link">Options: légende, titre…</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation14.html" class="sidebar-item-text sidebar-link">Combiner des graphiques</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Chapitre 2: macros</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation21.html" class="sidebar-item-text sidebar-link">Rappels sur les macros</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation22.html" class="sidebar-item-text sidebar-link">Alleger la syntaxe</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation23.html" class="sidebar-item-text sidebar-link">Automatiser la programmation</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Chapitre 3: palettes et styles</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation31.html" class="sidebar-item-text sidebar-link">Palettes de couleurs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formation32.html" class="sidebar-item-text sidebar-link">Styles-thèmes</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">Chapitre 4: [A venir]</span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">Chapitre 5: [A venir]</span>
  </li>
          <li class="sidebar-item">
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Ressources graphiques</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Stata.html" class="sidebar-item-text sidebar-link">Graphiques Stata</a>
  </div>
</li>
          <li class="sidebar-item">
  Python.qmd
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#types-de-graphique-syntaxe" id="toc-types-de-graphique-syntaxe" class="nav-link active" data-scroll-target="#types-de-graphique-syntaxe"><strong>Types de graphique syntaxe</strong></a>
  <ul class="collapse">
  <li><a href="#types-de-graphique" id="toc-types-de-graphique" class="nav-link" data-scroll-target="#types-de-graphique"><strong>Types de graphique</strong></a></li>
  <li><a href="#choix-du-délimiteur" id="toc-choix-du-délimiteur" class="nav-link" data-scroll-target="#choix-du-délimiteur"><strong>Choix du délimiteur</strong></a></li>
  <li><a href="#eléments-de-syntaxe" id="toc-eléments-de-syntaxe" class="nav-link" data-scroll-target="#eléments-de-syntaxe"><strong>Eléments de syntaxe</strong></a>
  <ul class="collapse">
  <li><a href="#un-bloc-dobjets-graphiques-même-type" id="toc-un-bloc-dobjets-graphiques-même-type" class="nav-link" data-scroll-target="#un-bloc-dobjets-graphiques-même-type"><strong>Un bloc d’objets graphiques (même type)</strong></a></li>
  <li><a href="#plusieurs-blocs-dobjets-graphiques" id="toc-plusieurs-blocs-dobjets-graphiques" class="nav-link" data-scroll-target="#plusieurs-blocs-dobjets-graphiques"><strong>Plusieurs blocs d’objets graphiques</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#options" id="toc-options" class="nav-link" data-scroll-target="#options"><strong>Options</strong></a>
  <ul class="collapse">
  <li><a href="#couleurs-et-épaisseurs" id="toc-couleurs-et-épaisseurs" class="nav-link" data-scroll-target="#couleurs-et-épaisseurs"><strong>Couleurs et épaisseurs</strong></a>
  <ul class="collapse">
  <li><a href="#couleurs" id="toc-couleurs" class="nav-link" data-scroll-target="#couleurs"><strong>Couleurs</strong></a></li>
  <li><a href="#taillesépaisseurs" id="toc-taillesépaisseurs" class="nav-link" data-scroll-target="#taillesépaisseurs"><strong>Tailles/épaisseurs</strong></a></li>
  <li><a href="#exercice" id="toc-exercice" class="nav-link" data-scroll-target="#exercice"><strong>Exercice</strong></a></li>
  </ul></li>
  <li><a href="#options-pour-les-axes" id="toc-options-pour-les-axes" class="nav-link" data-scroll-target="#options-pour-les-axes"><strong>Options pour les axes</strong></a>
  <ul class="collapse">
  <li><a href="#titres-des-axes" id="toc-titres-des-axes" class="nav-link" data-scroll-target="#titres-des-axes"><strong>Titres des axes</strong></a></li>
  <li><a href="#coordonnées-labels-grid" id="toc-coordonnées-labels-grid" class="nav-link" data-scroll-target="#coordonnées-labels-grid"><strong>Coordonnées, labels, grid</strong></a></li>
  <li><a href="#echelles" id="toc-echelles" class="nav-link" data-scroll-target="#echelles"><strong>Echelles</strong></a></li>
  </ul></li>
  <li><a href="#options-pour-la-légende" id="toc-options-pour-la-légende" class="nav-link" data-scroll-target="#options-pour-la-légende"><strong>Options pour la légende</strong></a></li>
  <li><a href="#autres-options" id="toc-autres-options" class="nav-link" data-scroll-target="#autres-options"><strong>Autres options</strong></a>
  <ul class="collapse">
  <li><a href="#changer-la-police-par-défaut" id="toc-changer-la-police-par-défaut" class="nav-link" data-scroll-target="#changer-la-police-par-défaut"><strong>Changer la police par défaut</strong></a></li>
  <li><a href="#taille-du-graphique" id="toc-taille-du-graphique" class="nav-link" data-scroll-target="#taille-du-graphique"><strong>Taille du graphique</strong></a></li>
  <li><a href="#modifier-automatiquement-la-taille-du-texte-et-des-symboles" id="toc-modifier-automatiquement-la-taille-du-texte-et-des-symboles" class="nav-link" data-scroll-target="#modifier-automatiquement-la-taille-du-texte-et-des-symboles"><strong>Modifier automatiquement la taille du texte et des symboles</strong></a></li>
  <li><a href="#options-daffichage-et-denregistrement" id="toc-options-daffichage-et-denregistrement" class="nav-link" data-scroll-target="#options-daffichage-et-denregistrement"><strong>Options d’affichage et d’enregistrement</strong></a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Chapitre 1</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><br></p>
<p>Les programmes de ce chapitre sont disponibles à l’adresse :<br>
<strong>https://github.com/mthevenin/stata_graphiques/blob/main/programmes/chapitre1.do</strong></p>
<section id="types-de-graphique-syntaxe" class="level1">
<h1><strong>Types de graphique syntaxe</strong></h1>
<section id="types-de-graphique" class="level2">
<h2 class="anchored" data-anchor-id="types-de-graphique"><strong>Types de graphique</strong></h2>
<p>On peut identifier deux types de graphiques avec Stata.</p>
<ul>
<li>Les <strong><em>graphiques de type one-way</em></strong> : coordonnées sur un seul axe avec ou non, un axe discret. Ils peuvent être préfixés ou non par <code>graph</code>: <strong><code>graph box</code></strong>, <strong><code>graph bar</code></strong>, <strong><code>histogram</code></strong> …..<br>
</li>
<li>Les <strong><em>graphiques de type two-way</em></strong> : coordonnées sur deux axes, optionnellement selon le type de graphique un troisième axe peut être renseigné. Ils sont préfixés ou non par <code>tw</code> (twoway) : <code>tw scatter</code>, <code>tw line</code>, …</li>
</ul>
<p>Certains types de graphiques sont de type oneway ou twoway. C’est le cas des histogrammes avec une commande <code>histogram</code> et une commande <code>tw histogram</code>.<br>
<br> Les coordonnées sont généralement renseignées par des noms de variables. Pour certaines commandes graphiques, les valeurs sont directement renseignées: <code>tw scatteri</code> pour un nuage ou <code>tw pci</code> pour des segments [ici 4 coordonnées : (ymin, xmin) et (ymax, xmax)].<br>
Un graphique peut être aussi généré par une fonction : <code>tw function y = f(x)</code>.</p>
<p>On peut obtenir la liste et aides des commandes graphiques officielles avec <strong><code>help graph</code></strong>.</p>
</section>
<section id="choix-du-délimiteur" class="level2">
<h2 class="anchored" data-anchor-id="choix-du-délimiteur"><strong>Choix du délimiteur</strong></h2>
<p>Un graphique peut devenir assez gourmand en options. Par défaut avec Stata l’exécution est faite ligne par ligne avec l’option par défaut <code>#delimit cr</code>. Pour exécuter une commande sur plusieurs lignes, il est d’usage d’utiliser un triple slash <strong><code>///</code></strong>. Pour les graphiques, cette option manque de souplesse et peut provoquer des messages d’erreur lorsque <strong><code>///</code></strong> est attaché par inadvertance au dernier caractère d’une ligne.<br>
Lorsque le nombre de lignes devient assez conséquent, il est préférable d’utiliser <strong><code>;</code></strong> comme délimiteur. Le changement de délimiteur se fait avec <strong><code>#delimit ;</code></strong> et on indique la fin de l’exécution avec <code>;</code>. On retourne au délimiteur par défaut avec <strong><code>#delimit cr</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit ;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tw scatter y x,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>[option1]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>[option2]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>[option3]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>[option n]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit cr</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Suite du programm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eléments-de-syntaxe" class="level2">
<h2 class="anchored" data-anchor-id="eléments-de-syntaxe"><strong>Eléments de syntaxe</strong></h2>
<p>Pour des raisons de vocabulaire, nous allons utiliser le terme de géométrie utilisée par l’incontournable librairie <strong>ggplot2</strong> de <strong>R</strong> pour identifier un type de graphique comme scatter, line…. Mais pas seulement. en fin de document je traite de l’utilisation de la librairie <strong>Python</strong> <strong><code>plotnine</code></strong>, qui est un wrapper relativement complet de ggplot2, directement exécutable dans un éditeur .do ou .ado. depuis la version 16 de Stata.<br>
En première approche, la syntaxe d’un graphique avec Stata est particulièrement simple :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>[tw<span class="sc">/</span>graph] type_géométrie coordonnées [<span class="cf">if</span><span class="sc">/</span><span class="cf">in</span>] [weight], [options géométrie] [,[options du graphique]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<section id="un-bloc-dobjets-graphiques-même-type" class="level3">
<h3 class="anchored" data-anchor-id="un-bloc-dobjets-graphiques-même-type"><strong>Un bloc d’objets graphiques (même type)</strong></h3>
<p>Un graphique comportant plusieurs géométries de même type peut être exécuté avec un seul bloc de coordonnées renseigné par des variables pour l’axe des ordonnées. Ces différentes coordonnées peuvent être des variables correspondant à plusieurs valeurs d’une variable additionnelle, souvent de type catégoriel [voir la commande separate plus bas].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>[tw<span class="sc">/</span>graph] type_géométrie Y1 Y2 Y3.... [X] [, <span class="fu">option1</span>(Y1 Y2 Y3...)..options_du graphique]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les options de la géométrie (plusieurs coordonnées pour Y) comme les couleurs ou les tailles/épaisseurs sont indiquées à la suite dans l’option choisie. Si on veut changer les couleurs de plusieurs courbes associées aux variable y1,y2 et y3: <code>color(couleurY1 couleurY2 couleurY3)</code>.</p>
<p><strong><em>Exemple</em></strong></p>
<p>Graphique de type <code>line</code>, reportant les espérances de vie aux USA de 1900 à 2000. Le premier graphique est sans option, le second en comporte.</p>
<p><img src="imgp1/g1.png" class="img-fluid" style="width:50.0%"></p>
<p><em>Premier graphique (haut)</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sysuse lifeexp, clear</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tw line le_male le_female year </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Second graphique (bas)</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sysuse lifeexp, clear</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit ;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>tw line  le_male le_female year, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                         </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lc</span>(<span class="sc">*</span>.<span class="dv">8</span> <span class="sc">*</span><span class="fl">1.2</span>)                                                        </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lw</span>(<span class="sc">*</span><span class="dv">4</span> <span class="sc">*</span><span class="dv">4</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                                               </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="st">"Espérance de vie aux USA"</span>, <span class="fu">pos</span>(<span class="dv">11</span>))                                  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="fu">order</span>(<span class="dv">1</span> <span class="st">"Hommes"</span> <span class="dv">2</span> <span class="st">"Femmes"</span>) <span class="fu">pos</span>(<span class="dv">4</span>) <span class="fu">col</span>(<span class="dv">1</span>) <span class="fu">ring</span>(<span class="dv">0</span>))             </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylabel</span>(<span class="dv">35</span>(<span class="dv">5</span>)<span class="dv">80</span>, <span class="fu">angle</span>(<span class="dv">0</span>))  </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xtitle</span>(<span class="st">"Année"</span>)   </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">graphr</span>(<span class="fu">color</span>(white)) <span class="fu">plotr</span>(<span class="fu">color</span>(white))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:1em;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M104 224H24c-13.255 0-24 10.745-24 24v240c0 13.255 10.745 24 24 24h80c13.255 0 24-10.745 24-24V248c0-13.255-10.745-24-24-24zM64 472c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zM384 81.452c0 42.416-25.97 66.208-33.277 94.548h101.723c33.397 0 59.397 27.746 59.553 58.098.084 17.938-7.546 37.249-19.439 49.197l-.11.11c9.836 23.337 8.237 56.037-9.308 79.469 8.681 25.895-.069 57.704-16.382 74.757 4.298 17.598 2.244 32.575-6.148 44.632C440.202 511.587 389.616 512 346.839 512l-2.845-.001c-48.287-.017-87.806-17.598-119.56-31.725-15.957-7.099-36.821-15.887-52.651-16.178-6.54-.12-11.783-5.457-11.783-11.998v-213.77c0-3.2 1.282-6.271 3.558-8.521 39.614-39.144 56.648-80.587 89.117-113.111 14.804-14.832 20.188-37.236 25.393-58.902C282.515 39.293 291.817 0 312 0c24 0 72 8 72 81.452z"></path></svg> Avec le changement de délimiteur, il est plus facile de distinguer les différents éléments du graphique, comme les options qui affectent directement les courbes (couleur, épaisseur) et les options générales du graphique (titre, légende, labels de y à l’horizontal, titre de x, couleur de fond).</p>
</div>
</div>
<p><strong><em>Options des courbes</em></strong>:</p>
<ul>
<li><code>lc(...)</code>: je baisse la saturation de la courbe des hommes de 20% (plus claire) et j’augmente celle des femmes de 20% (plus foncée). Les couleurs par défaut sont conservées (palette Stata s2color).</li>
<li><code>lw(...)</code>: j’augmente fortement l’épaisseur des courbes (*4). Stata dispose de plusieurs unités pour altérer les tailles et épaisseurs, celle utilisée par défaut est une unité de type relative (voir la section dédiées plus bas).</li>
</ul>
<p><strong><em>Options du graphique</em></strong>:</p>
<ul>
<li>J’ajoute un titre avec l’option <code>title(…)</code> que je positionne à 11 heures à l’extérieur avec l’argument <code>pos(11)</code>.</li>
<li>Je change les labels de la légende dans l’option <code>legend(...)</code> avec l’argument <code>order(...)</code>. Je change la position de la légende en a mettant dans la zône du graphique avec <code>ring(0)</code> et à 4 heures avec <code>pos(4)</code>. Les labels sont reportés sur une colonne avec l’argument <code>col(1)</code>.</li>
<li>Je modifie les labels des ordonnées avec l’option <code>ylabel(...)</code>, en changeant le delta des coordonnées reportées et en mettant les labels à l’horizontal avec l’argument <code>angle(0)</code>.</li>
<li>Je modifie le titre des abscisses avec l’option <code>xtitle(...)</code>.</li>
<li>Je modifie les couleurs de fonds du graphique qui est composée de deux zônes: la zône où est réellement tracé le graphique avec l’option <code>plotr()</code> [ou <code>plotregion(...)</code>] et la zône externe avec <code>graphr(...)</code> [ou <code>graphregion(...)</code>] où se trouve reporté par défaut les titres et les légendes. Pour changer la couleur de fond, on utilise l’argument <code>color(...)</code>.</li>
</ul>
</section>
<section id="plusieurs-blocs-dobjets-graphiques" class="level3">
<h3 class="anchored" data-anchor-id="plusieurs-blocs-dobjets-graphiques"><strong>Plusieurs blocs d’objets graphiques</strong></h3>
<p>Dans l’exemple précédent on avait deux variables, mais il est plus standard que les bases donnent des observations à partir d’une variable qui peut être croisées avec d’autres informations regroupées avec une variable discrète. Par rapport à d’autres langages graphiques, on pense bien évidemment à R avec ggplot, les choses se gâtent un peu du côté de Stata car plusieurs graphiques doivent être exécutés séparément dans la même commande. On donnera plus loin un moyen via les macros et les boucles d’automatiser cette exécution. Cela ne concerne que les éléments surperposés, Stata possédant en revanche une option pour générer des sous graphiques de type facettes ou small-multiple (voir section sur les graphiques combinés).<br>
Chaque sous graphique a son propre jeu d’options et ont doit bien indiquer leur séparation, soit avec des parenthèses soit avec des doubles barres horizontales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(graph <span class="dv">1</span>, options graph1) (graph2, options graph2)… (graph n, option graph n) , options graphiques</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ou</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>graph <span class="dv">1</span>, options graph1 <span class="sc">||</span> graph2, options graph2 <span class="sc">||</span>…. <span class="sc">||</span> graph n, option graph n <span class="sc">||</span> , options graphiques</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ma préférence va plutôt à la deuxième solution pour éviter une surabondance de parenthèses déjà très présentes, et souvent imbriquées dans les options. Par ailleurs il me semble qu’on visualise mieux la séparation entre les différents éléments graphiques.</p>
<p>Principe de la syntaxe avec <code>;</code> comme délimiteur</p>
<p><em>Graphiques séparés par ()</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit ;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>[tw<span class="sc">/</span>graph] </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>(type_géométrie1 Y1 [X1] [Y2] [X2] [Z] [<span class="cf">in</span> <span class="cf">if</span>] [weight]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>[, <span class="fu">options</span>(<span class="dv">1</span>)]) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>(type_géométrie2 Y2 [X1] [Y2] [X2] [Z] [<span class="cf">in</span> <span class="cf">if</span>] [weight]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>[, <span class="fu">options</span>(<span class="dv">2</span>)])</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>...<span class="er">)</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>[, options_graphiques] </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>; </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Graphiques séparés par ||</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit ;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>[tw<span class="sc">/</span>graph] </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   type_géométrie1 Y1 [X1] [Y2] [X2] [Z] [<span class="cf">in</span> <span class="cf">if</span>] [weight]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>[, <span class="fu">options</span>(<span class="dv">1</span>)] </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span> type_géométrie2 Y2 [X1] [Y2] [X2] [Z] [<span class="cf">in</span> <span class="cf">if</span>] [weight]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>[, <span class="fu">options</span>(<span class="dv">2</span>)]<span class="er">)</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>...                                    </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span> [, options_graphiques] </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>;  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Exemple</em></strong></p>
<p>Comme dans le premier graphique, celui du haut est sans option et celui du bas avec. On va afficher un nuage de point avec la base auto, entre les variables price et mpg (consommation d’essence en gallon) selon l’origine de la voiture (US ou autres pays).</p>
<p><img src="imgp1/g2.png" class="img-fluid" style="width:50.0%"></p>
<p><em>Premier graphique</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sysuse auto, clear</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>tw </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    scatter price mpg <span class="cf">if</span> <span class="sc">!</span>foreign</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span>  scatter price mpg <span class="cf">if</span>  foreign</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span>, <span class="fu">legend</span>(<span class="fu">order</span>(<span class="dv">1</span> <span class="st">"US"</span> <span class="dv">2</span> <span class="st">"Autres"</span>))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Lorsqu’on superpose les sous graphiques de cette manière, Stata ne reconnait pas par défaut les labels à affecter à la légende, et affiche deux fois le label price pour chaque origine. On doit renseigner manuellement cette information.</li>
<li>Petite astuce pas forcément connue de toutes et tous. Lorsqu’une variable est de type indicatrice {0,1} il n’est pas nécessaire de préciser sa valeur:
<ul>
<li><code>!foreign</code> est identique à <code>foreign==0</code></li>
<li><code>foreign</code> est identique à <code>foreign==1</code></li>
</ul></li>
</ul>
</div>
</div>
<p><em>Second graphique</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delimit ;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tw </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>   scatter price mpg <span class="cf">if</span> <span class="sc">!</span>foreign, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mc</span>(<span class="st">"31 161 135%60"</span>) <span class="fu">msize</span>(<span class="sc">*</span><span class="fl">1.5</span>) <span class="fu">mlc</span>(black) <span class="fu">mlw</span>(.<span class="dv">3</span>) <span class="fu">jitter</span>(<span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span> scatter price mpg <span class="cf">if</span> foreign, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mc</span>(<span class="st">"207 225 28%60"</span>) <span class="fu">msize</span>(<span class="sc">*</span><span class="fl">1.5</span>) <span class="fu">mlc</span>(black) <span class="fu">mlw</span>(.<span class="dv">3</span>) <span class="fu">jitter</span>(<span class="dv">1</span>) </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="sc">||</span>, <span class="fu">title</span>(<span class="st">"{bf: Prix et consommation selon l'origine}"</span>, <span class="fu">pos</span>(<span class="dv">11</span>))   </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="fu">order</span>(<span class="dv">1</span> <span class="st">"US"</span> <span class="dv">2</span> <span class="st">"Autres"</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylabel</span>(<span class="dv">5000</span> “5k” <span class="dv">10000</span> “10k” <span class="dv">15000</span> “15k”, <span class="fu">angle</span>(<span class="dv">0</span>)) </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xtitle</span>(<span class="st">"Consommation (miles par gallon)"</span>) </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ytitle</span>(<span class="st">"Prix"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">graphr</span>(<span class="fu">color</span>(white)) <span class="fu">plotr</span>(<span class="fu">color</span>(white))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Options des nuages</em></strong></p>
<ul>
<li><code>mc(...)</code> modifie la couleur des bulles. On verra par la suite plus en détail les altérations des couleurs, mais ici on a manuellement changé leur couleur avec un code RGB sur lequel on a réduit l’opacité à 60% (ou mis 40% de transparence).</li>
<li><code>mlc(...)</code> modifie la couleur du contour des bulles, ici en noir. Par défaut la couleur du contour est identique à la couleur de remplissage de la bulle.</li>
<li><code>msize()</code> modifie la taille de la bulle.</li>
<li><code>mlw()</code> modifie l’épaisseur du contour de la bulle.</li>
<li><code>jitter()</code> : très à la mode, les jitters sont des nuages dont les coordonnées ont été perturbées aléatoirement pour réduire les effets de superposition, ici liés à la variable mpg. A utiliser avec prudence, et éviter de trop modifier les coordonnées lorsque les coordonnées représentent des valeurs continues.</li>
</ul>
<p><strong><em>Options du graphique</em></strong></p>
<ul>
<li>Le titre a été mis en gras avec une balise SMCL (Stata Markup Control Langage) : <code>"{bf :texte}"</code>.</li>
<li>Les valeurs des prix reportés sur l’axe des ordonnées à été modifié manuellement avec des unités k (1k = 1000).</li>
<li>Le reste des options sont de même nature que celles relative au graphique précédent sur les espérances de vie.</li>
</ul>
</section>
</section>
</section>
<section id="options" class="level1">
<h1><strong>Options</strong></h1>
<p>Il s’agit ici d’un tour d’horizon forcément incomplet des options qui vont permettre de modifier et d’habiller les graphiques, afin d’en améliorer la visibilité. On va regarder principalement les options liées aux couleurs, tailles/épaisseurs ; et quelques paramètres de bases pour les axes, légendes, titres. L’idée est de ne traiter que des options qui sont utilisées au moins une fois dans le document.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Un très bon cheatsheet:<br>
* <a href="https://geocenter.github.io/StataTraining/pdf/StataCheatSheet_visualization15_Syntax_2016_June-REV.pdf" class="uri">https://geocenter.github.io/StataTraining/pdf/StataCheatSheet_visualization15_Syntax_2016_June-REV.pdf</a> * <a href="https://geocenter.github.io/StataTraining/pdf/StataCheatSheet_visualization15_Plots_2016_June-REV.pdf" class="uri">https://geocenter.github.io/StataTraining/pdf/StataCheatSheet_visualization15_Plots_2016_June-REV.pdf</a></p>
</div>
</div>
<section id="couleurs-et-épaisseurs" class="level2">
<h2 class="anchored" data-anchor-id="couleurs-et-épaisseurs"><strong>Couleurs et épaisseurs</strong></h2>
<section id="couleurs" class="level3">
<h3 class="anchored" data-anchor-id="couleurs"><strong>Couleurs</strong></h3>
<p><strong><em>Se reporter au chapitre 3, pour un tour d’horizon plus complet sur les couleurs et les palettes de couleurs [mettre lien]</em></strong></p>
<p>3 Eléments entrent dans les options relatives aux couleurs.</p>
<p><strong>Nom - code couleur</strong> Un nom de couleur prédéfini ou un code couleur numérique : la couleur <code>navy</code> (première couleur de la palette Stata <em>s2</em>) a pour code RGB [Red-Green-Blue] <code>"26 71 11"</code>.<br>
Pour un élément de type ligne, courbe… : <strong><code>lc(navy)</code></strong> = <strong><code>lc("26 71 11")</code></strong></p>
<p><strong>Saturation/intensité</strong> On peut modifier la saturation : clair (blanc) &lt;=&gt; foncé (noir). Une couleur par défaut ou renseignée manuellement a une intensité de 1. On tire vers le blanc en réduisant cette saturation, vers le noir en l’augmentant. Après le nom ou le code couleur, l’intensité est modifiée par <strong><code>*#</code></strong> avec # supérieur ou égal à 0 (0=blanc).<br>
Pour un élément de type barre, l’option pour modifier une couleur est donnée par <code>fc()</code> (f pour fill, c pour color tronqué) : <code>fc(*.5)</code> réduit la saturation de 50% de la couleur par défaut, <code>fc("26 71 11*1.2")</code> augmente de 20% la saturation de la couleur navy, ici renseignée par son code RGB.</p>
<p><strong>Transparence</strong> En retard sur ce point jusqu’à la version 15 de Stata, on peut maintenant modifier l’opacité (transparence) des couleurs. La transparence permet de gérer les effets de superposition, mais on doit se méfier des effets de flou qui peuvent se révéler assez désagréable, en particulier pour les nuages en l’absence de contour sur les bulles. L’argument de l’option exprime un pourcentage d’opacité avec comme valeur minimale 0 et une valeur maximale 100 (100 = valeur par défaut). Après le nom ou le code de la couleur, l’opacité est réduite par %#. On peut utiliser une transparence totale (%0) pour cacher des éléments d’un graphique.</p>
<p>Pour un élément de type bulle : <code>mc(%50)</code> réduit de moitié l’opacité de la couleur par défaut, <code>mc("26 71 11%70")</code> applique 70% de transparence à la couleur navy.</p>
<p>Comme on le voit dans le second graphique ci-dessous, il n’y a pas trop de sens à baisser simultanément la saturation et l’opacité, une couleur plus transparente étant plus claire. On peut à l’inverse augmenter la saturation et baisser l’opacité.</p>
<p><img src="imgp1/g3.png" class="img-fluid" style="width:50.0%"></p>
<p><img src="imgp1/g4.png" class="img-fluid" style="width:50.0%"></p>
<p><img src="imgp1/g5.png" class="img-fluid" style="width:50.0%"></p>
</section>
<section id="taillesépaisseurs" class="level3">
<h3 class="anchored" data-anchor-id="taillesépaisseurs"><strong>Tailles/épaisseurs</strong></h3>
<p>On peut altérer les tailles et épaisseurs d’éléments composants le graphiques en s’appuyant soit sur des arguments prédéfinis, soit en jouant sur les valeurs de plusieurs types d’unités, absolues (cm, point, pouce) ou relatives. Certaines ont été implémentées à la version 16 de Stata. Lorsqu’elles sont prédéfinies, leur mémorisation peut s’avérer un peu laborieuse avec une liste qui diffère selon le type d’objet. On peut donc privilégier la modification directe des valeurs en choissisant des unités absolues (pouces, cm) ou relative. Dans mes graphiques, je priviliégie sauf exception l’utilisation de valeurs relatives.</p>
<p><strong><em>Tailles prédéfinies</em></strong></p>
<p><img src="imgp1/g6.png" class="img-fluid" style="width:50.0%"></p>
<p><br> <img src="imgp1/g7.png" class="img-fluid" style="width:50.0%"></p>
<p><br> <img src="imgp1/g8.png" class="img-fluid" style="width:50.0%"></p>
<p><strong><em>Tailles reposant sur des valeurs</em></strong></p>
<p>Pour modifier directement les valeurs des tailles et épaisseurs Stata propose 6 unités : 3 absolues et 3 relatives. Ces dernières sont un peu obscures au niveau de la définition de la valeur de référence. <code>#</code> donne la valeur de la modification.</p>
<p>Absolues (par ordre décroissant) : le pouce (<code>#in</code>), le centimètre (<code>#cm</code>), et le point (<code>#pt</code>).<br>
<br> Relatives:</p>
<ul>
<li><p><code>option(#rs)</code>: valeur relative par rapport au minimum de la longueur et de la largeur du graphique (=100). Si option(.5rs) et que le graphique fait 10 de largeur et 20 de longueur, la référence est associée à la largeur et est égale à 100. La taille ou l’épaisseur de l’élément fera alors .5% de cette référence. L’aide de Stata ne s’attarde pas sur ce type de modification, pas forcément très claire.</p></li>
<li><p><code>option(#)</code> : également une valeur par rapport au minimum de la largeur et de la longueur, mais on garde cette valeur comme référence. Avec option(.5) et que le minimum est toujours égal à 10 (largeur), la taille ou l’épaisseur de l’élément est égale à .5% de 10.</p></li>
<li><p><code>option(*#)</code> : coefficient multiplicateur d’une taille ou épaisseur par défaut définie par le style (thème) du graphique. Je privilégie ce type de paramétrisation. Sauf exception, j’utilise cette option.</p></li>
</ul>
<p><img src="imgp1/g9.png" class="img-fluid" style="width:50.0%"></p>
</section>
<section id="exercice" class="level3">
<h3 class="anchored" data-anchor-id="exercice"><strong>Exercice</strong></h3>
<p>Reproduire les deux graphiques ci-dessous avec la base auto: <code>sysuse auto.dta</code>.</p>
<p>Solution : <a href="https://github.com/mthevenin/stata_fr/blob/master/exercices/exo1" class="uri">https://github.com/mthevenin/stata_fr/blob/master/exercices/exo1</a></p>
<div class="alert alert-info">
<p><strong>Graphique(s) 1</strong></p>
<ul>
<li>Reproduire l’un et/ou l’autre de ces graphiques avec les variables <em>mpg</em> et <em>foreign</em>.</li>
<li>Les histogrammes sont générés avec la fonction <strong><code>tw histogram</code></strong> (à préférer à la commande de type oneway <code>histogram</code>).</li>
<li>Les densités sont estimées avec la fonction <strong><code>kdensity</code></strong> [<code>help kdensity</code>] et le graphique est généré avec <strong><code>tw area</code></strong> [<code>help twoway area</code>].</li>
<li>Les couleurs sont issues de la palette de type séquentielle <strong>YlGnBu</strong> de la collection Brewer (voir le chapitre sur les palettes de couleur). les codes des deux couleurs sont <strong><code>"34 94 168"</code></strong> et <strong><code>"139 209 187"</code></strong>.
<hr>
<img src="imgp1/g10.png" class="img-fluid" style="width:60.0%"></li>
</ul>
</div>
<div class="alert alert-info">
<p><strong>Graphique(s) 2</strong></p>
<ul>
<li>Nuage de points des variables price et mpg pour les deux modalités de la variable foreign, avec report des OLS.</li>
<li>La droite de l’OLS est générée avec le type de graphique tw lfitci:</li>
<li>Couleur de la droite : option <strong><code>clc()</code></strong></li>
<li>Couleur de remplissage l’intervalle de confiance: option <strong><code>fc()</code></strong></li>
<li>Couleur du contour de l’intervalle de confiance: option <strong><code>alc()</code></strong>
<hr>
<img src="imgp1/g11.png" class="img-fluid" style="width:60.0%"></li>
</ul>
</div>
</section>
</section>
<section id="options-pour-les-axes" class="level2">
<h2 class="anchored" data-anchor-id="options-pour-les-axes"><strong>Options pour les axes</strong></h2>
<p>On se limitera aux axes classiques (x,y). Dans les cas particuliers des dates et des graphiques admettant un 3ème axe (graphique type contour), les options sont précédées du préfixe <code>t</code> ou <code>z</code>.</p>
<p>Il y a 3 types options pour modifier les axes x/y x : <strong><code>x/ylabel()</code></strong>, <strong><code>x/ytitle()</code></strong>, <strong><code>x/yscale()</code></strong>. Une autre option permet de définir le choix de l’axe si un graphique comporte plusieurs définitions d’axes pour les abscisses et/ou pour les ordonnées : <strong><code>x/yaxis(#)</code></strong> avec <code>#</code> le numéro de l’axe, qui sera par la suite reporté dans les autres options relatives aux axes.</p>
<section id="titres-des-axes" class="level3">
<h3 class="anchored" data-anchor-id="titres-des-axes"><strong>Titres des axes</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtitle</span>() <span class="fu">ytitle</span>()<span class="sc">:</span>  <span class="fu">xtitle</span>([<span class="st">"titres"</span>] [, options])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Principales options:</p>
<ul>
<li>Taille avec <code>size(...)</code>, couleur avec <code>color(...)</code>. Si on ajoute l’option <code>box(...)</code>, on peut modifier l’apparence de la zone qui l’entoure.</li>
<li>Titres sur plusieurs lignes: <strong><code>xtitle("ligne1" ligne2"....[, options])</code></strong></li>
<li>On peut modifier la position des titres des axes avec <code>place(top/right/bottom/left)</code> pour indiquer la position le long de l’axe (par exemple <code>right</code> pour x et <code>top</code> pour y) et contrôler leur éloignement de l’axe avec <code>width(#)</code> pour y et <code>height(#)</code> pour x. Le graphique suivant modifie les positions par défaut des titres :</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtitle</span>(<span class="st">", place(right) height(5)) </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="st">ytitle("</span>, <span class="fu">orient</span>(horizontal) <span class="fu">place</span>(top) <span class="fu">width</span>(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgp1/g12.png" class="img-fluid" style="width:50.0%"></p>
</section>
<section id="coordonnées-labels-grid" class="level3">
<h3 class="anchored" data-anchor-id="coordonnées-labels-grid"><strong>Coordonnées, labels, grid</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel</span>() <span class="fu">ylabel</span>()<span class="sc">:</span> <span class="fu">xlabel</span>([coordonnées] [,options])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Modification des valeurs reportées sur les axes</em></strong>:</p>
<ul>
<li>Avec <strong>valeur_min(delta)valeur_max</strong>: <code>xlabel(0(10)100)</code> =&gt; de 0 à 100 avec un incrément de 10.</li>
<li>En indiquant le nombre de valeurs à reporter sur l’axe : <code>xlabel(#)</code>.</li>
<li>Manuellement: <code>xlabel( #1 #2 "label" "label2"…)</code> ou <code>xlabel( #1 "label1" #2 "label2"...)</code>.<br>
</li>
<li>On peut mélanger les approches : <code>xlabel(0 .5 1(1)10 15 20 "Vingt" )</code>.</li>
</ul>
<p><strong><em>Principales options</em></strong>:</p>
<ul>
<li>Taille et couleur du texte avec <strong><code>labs(...)</code></strong> et <strong><code>labc(...)</code></strong>.</li>
<li>Alterner les positions pour éviter les chevauchements avec <code>alt</code>.</li>
<li>Modifier l’angle de report des labels : <code>angle(#)</code> avec # valeur de l’angle [0 (horizontal), 45, 90 (vertical) …].</li>
<li>Modification du grid et des coches (tick) : la couleur avec <code>glc(...)</code> et <code>tlc(...)</code> et l’épaisseur avec <code>glw(...)</code> et <code>tlw(...)</code>.</li>
</ul>
</section>
<section id="echelles" class="level3">
<h3 class="anchored" data-anchor-id="echelles"><strong>Echelles</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xscale</span>() <span class="fu">yscale</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Utilisation d’une échelle logarithmique : <em><code>log</code></em>. Seule l’échelle est modifiée, les valeurs d’origines sont reportées sur l’axe, ce qui est plutôt bien vu.</li>
<li>Echelle en ordre décroissant : <code>reverse</code>. Pas conseillé, mais on peut trouver une certaine utilité aux graphiques combinés reportant des distributions croisées et marginales (voir la section dédiée aux graphiques combinés).</li>
<li>Supprimer l’affichage des axes : <code>off</code>.</li>
<li>Ne pas tracer la ligne parcourant l’axe : <code>noline</code>.</li>
<li>Modifier les limites de l’axe : <code>range(min max)</code>. Plutôt utile pour l’ajout d’éléments de type texte proche des axes.</li>
</ul>
<p>Les graphiques suivant donnent quelques exemples de modification des options des axes. Les données sont issues de la base d’exemple <em>lifeexp</em> [<code>sysuse lifeexp, clear</code>] et les graphiques reportent sous forme de nuage les espérances de vie à la naissance (y) et le revenu par habitant (x).</p>
<p><img src="imgp1/g13.png" class="img-fluid" style="width:90.0%"></p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
La zône en bas à droite étant un graphique « vide » avec seulement une note, pour la dernière option reportée le label doit-être indiqué par des doubles quotes “label” et non par ‘label’: xlabel(1000 “1k” 5000 “5k” 10000 “10k” 20000 “20k” 30000 “30k” 40000 “40k”) et non xlabel(1000 ‘1k’……). Il m’a fallu composer avec la syntaxe permise pour les éléments de type texte.
</div>
</div>
</section></section></section></main></div>


<section id="options-pour-la-légende" class="level2">
<h2 data-anchor-id="options-pour-la-légende"><strong>Options pour la légende</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(), <span class="fu">clegend</span>(), plegend<span class="sc">:</span> <span class="fu">legend</span>(contenu [options])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les options <strong><code>clegend()</code></strong> et <strong><code>plegend()</code></strong> sont réservées aux graphiques de type courbes de niveau avec une troisième dimension (hauteur, densité…): <code>clegend()</code> pour <code>tw contour</code> et <code>plegend()</code> pour <code>tw contourline</code>. Ces options ont des arguments spécifiques que je ne décrirais pas ici.</p>
<p>Stata utilise par défaut le label de la variable y pour alimenter le contenu de la légende, ce qui peut conduire à un rendu inadapté qu’il faudra corriger manuellement ou à l’aide de macros et fonctions macro (voir chapitre2).</p>
<ul>
<li>Ne pas afficher une légende: <strong><code>legend(off)</code></strong>.</li>
<li>Position par défaut: 6 heures (Sud) – à l’extérieur. Modifiable avec <code>pos(#)</code> et <code>ring(0 ou 1)</code>.</li>
<li>Pour modifier le nombre de lignes et de colonnes: <code>row(#)</code> et <code>col(#)</code>.</li>
<li>Pour modifier les labels de la légende:</li>
<li><strong><code>order(...)</code></strong> : <code>order( 1 "label1" 2 "label2" .....)</code> ou</li>
<li><strong><code>lab(...)</code></strong> : <code>lab(1 "label1") lab(2 "label2") ...)</code></li>
</ul>
<p>J’utilise de préférence order plus parcimonieux en parenthèses. L’apparence (gras, italique…) des labels est modifiable avec des balises smcl ; les tailles et couleurs sont également modifiables avec des options pour les textes.</p>
<ul>
<li>Les labels peuvent être reportés sous les symboles avec l’option <strong><code>stack</code></strong>.</li>
<li>On peut modifier l’aspect de la zône (couleur du fond, contour…) avec la sous option **<code>region(...)</code> ou <code>r(...)</code>.</li>
</ul>
<p><strong>Le smcl</strong> ::: {.callout-note} <strong>Le smcl</strong><br>
Le Smcl « <strong>Stata Markup Control Langage</strong> » est le langage d’édition de Stata, il faut le reconnaître un peu préhistorique (ce n’est pas du Markup pour rien). Pour les graphiques, il permet de modifier les textes des titres, labels des axes, contenu des légendes : gras, italique… changement de police, ajout de formules.<br>
Balise smcl : <code>"{type_option: texte}"</code></p>
<p>Quelques options/modifications de base :</p>
<ul>
<li>Gras : <code>"{bf: texte}"</code></li>
<li>Italique : <code>"{it: texte}"</code></li>
<li>Gras et italique : <code>"{bf:{it :texte}}"</code><br>
</li>
<li>Le choix des polices dépend du système d’exploitation. Elles sont sélectionnées par leur type : <code>"{stSans : texte}"</code> pour type sans serif, <code>"{stSerif : texte}"</code> pour type serif, <code>"{stMono: texte}"</code> pour type mono, et <code>"{stSymbol : texte}"</code> pour les lettres grecques ou les symboles mathématiques. Exemples de polices avec windows : <em>arial</em> (sans serif), <em>times new roman</em> (serif), <em>courrier new</em> ou <em>consolas</em> (mono) et <em>symbol</em> (symbol). On peut également utiliser toutes les typographies disponibles en les sélectionnant en amont, avec la commande <code>graph set</code>.
</li>
</ul>
<p><img src="imgp1/g14.png" class="img-fluid" style="width:90.0%"></p>
<p>Options de la légende :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fu">order</span>(<span class="dv">1</span> <span class="st">"{bf:Domestic}"</span> <span class="dv">2</span> <span class="st">"{bf:Foreign}"</span>) <span class="fu">pos</span>(<span class="dv">1</span>) <span class="fu">ring</span>(<span class="dv">0</span>) <span class="fu">col</span>(<span class="dv">1</span>) <span class="fu">region</span>(<span class="fu">lw</span>(<span class="sc">*</span>.<span class="dv">1</span>)) stack )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Le texte de labels a été mis en gras avec une balise Smcl.</li>
<li>La légende a été positionnée à l’intérieur du graphique avec <code>ring(0)</code> et à 1 heure avec <code>pos(1)</code>.</li>
<li>La légende est reportée sous forme de colonne avec <code>col(1)</code>.</li>
<li>L’épaisseur du contour de la zône a été fortement réduit avec <code>r(lw(*.1))</code>.</li>
<li>Le texte est positionné sous le symbole avec l’option <code>stack</code>.</li>
</ul>
</section>
<section id="autres-options" class="level2">
<h2 data-anchor-id="autres-options"><strong>Autres options</strong></h2>
<section id="changer-la-police-par-défaut" class="level3">
<h3 data-anchor-id="changer-la-police-par-défaut"><strong>Changer la police par défaut</strong></h3>
<p>On peut paramétrer en amont la typographie utiliser par les graphiques avec la commande <code>graph set</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> pour OS windows</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>graph set window fontface[type_police] <span class="st">"nom_police"</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le type de police est: <em>sans</em>, <em>serif</em>, <em>mono</em>, <em>symbol</em>.</p>
<p>Par défaut:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>   window           current</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>   setting          default          choices</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>   <span class="sc">----------------------------------------------------------------</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>   fontface         Arial             font name</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>   fontfacesans     Arial             font name</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>   fontfaceserif    Times New Roman   font name</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>   fontfacemono     Courier New       font name</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>   fontfacesymbol   Symbol            font name</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">---------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Exemple: avec Trebuchet MS pour fontface et consolas pour mono</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>graph set window fontface<span class="st">"trebuchet MS"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>graph set window fontfacemono <span class="st">"consolas"</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">*</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>   window           current</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>   setting          default          choices</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>   <span class="sc">------------------------------------------------------------------------</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>   fontface         trebuchet MS      font name</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>   fontfacesans     Arial             font name</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>   fontfaceserif    Minion Pro        font name</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>   fontfacemono     consolas          font name</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>   fontfacesymbol   Symbol            font name</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>   <span class="sc">------------------------------------------------------------------------</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="er">*/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="taille-du-graphique" class="level3">
<h3 data-anchor-id="taille-du-graphique"><strong>Taille du graphique</strong></h3>
<p>Ces options sont particulièrement utiles pour les graphiques combinés lorsque l’empilement de plusieurs graphiques provoque un effet d’écrasement des axes (axes x plus court si plusieurs colonnes par exemple).</p>
<ul>
<li><strong><code>xsize(#)</code></strong> - <strong><code>ysize(#)</code></strong> : en pouce (max=20). Peut s’appliquer à un graphique individuel, ou plus souvent à la commande <code>graph combine</code> pour retrouver un bon ratio x/y pour les sous graphiques.</li>
<li><strong><code>fxize(#)</code></strong> – <strong><code>fysize(#)</code></strong> : # en %. A utiliser seulement pour combiner des graphiques. Avant la combinaison on peut appliquer ces options aux graphiques individuels pour contrôler les ratios x/y. Cela permet plus de liberté dans les compositions des graphiques combinés.</li>
</ul>
<p>Une application est donnée plus loin dans la section dédiée aux graphiques combinés.</p>
<p><br></p>
</section>
<section id="modifier-automatiquement-la-taille-du-texte-et-des-symboles" class="level3">
<h3 data-anchor-id="modifier-automatiquement-la-taille-du-texte-et-des-symboles"><strong>Modifier automatiquement la taille du texte et des symboles</strong></h3>
<p><strong><code>scale(#)</code></strong> – **<code>iscale(#)</code>*<br>
Permet de modifier la taille des éléments types texte et symboles générés par un graphique. Utile lorsque le texte d’une légende sort du contour. Valeur de référence=1.<br>
Pour la commande <code>graph combine</code>, on utilise l’option <code>iscale()</code> qui appliquera la modification à tous les sous graphiques.</p>
<p><br></p>
</section>
<section id="options-daffichage-et-denregistrement" class="level3">
<h3 data-anchor-id="options-daffichage-et-denregistrement"><strong>Options d’affichage et d’enregistrement</strong></h3>
<ul>
<li><p><strong><code>nodraw</code></strong><br>
Equivalent de <code>quietly</code> pour les graphiques, il permet de ne pas afficher le graphique dans l’éditeur. Plutôt à utiliser pour les sous-graphiques qui seront combiner ou associer à l’option <code>saving()</code>. Cela permet de gagner un temps d’exécution non négligeabe.</p></li>
<li><p><strong><code>name()</code></strong>: <code>name(nom_graph [,replace])</code><br>
Permet de sauvegarder temporairement le graphique sur la session. On peut privilégier cette option pour combiner des graphiques ultérieurement.<br>
Utiliser de préférence l’option <code>replace</code> pour écraser un graphique déjà en mémoire et avec un même nom, à défaut de quoi il faut supprimer le ou les graphiques en mémoire avec <code>graph drop noms_graphs</code> ou <code>graph drop _all</code> en amont.</p></li>
<li><p><strong><code>graph display [nom_graph]</code></strong><br>
Permet d’afficher un graphique en mémoire (non sauvegardé en dur). Si le nom du graphique n’est pas précisé, le dernier graphique généré est ouvert dans l’éditeur de graphique.</p></li>
</ul>
<p>Exemple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a> graph display g1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><strong><code>saving("path/nom"[, replace])</code></strong><br>
Même principe que <code>name()</code>, mais sauvegarde en dur sur le disque.</p></li>
<li><p><strong><code>graph use "nom_graph"</code></strong><br>
Permet d’afficher un graphique enregistré.</p></li>
<li><p><strong>Exporter un graphique</strong><br>
<code>export nom_graph.format [, replace name(nom du graphique ouvert dans l’éditeur)]</code>. Stata peut convertir un graphique en plusieurs format : jpeg, png, gif (seulement mac), svg…. On peut le faire directement dans l’éditeur de graphique ou passer par la ligne de commande export. Pour utiliser cette commande, le graphique doit être ouvert dans l’éditeur. Les formats d’exportation on des options propres.</p></li>
</ul>
<p>Exemples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tw line y x</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>graph export graphpng.png</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>tw line y x, <span class="fu">name</span>(g1,replace)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>graph export graphpng.png, replace <span class="fu">name</span>(g1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>


 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
 <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Marc Thévenin - Ined-Sms - Août 2022</div>
  </div>
</footer>



</body></html>